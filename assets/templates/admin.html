<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Local File Hub</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
</head>

<body>

    <div class="app-layout">

        <div class="main-header">
            <div class="brand">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#3B82F6" width="24" height="24">
                    <path d="M11 15h2V9h3l-4-5-4 5h3z" />
                    <path d="M20 18H4v-7H2v7c0 1.103.897 2 2 2h16c1.103 0 2-.897 2-2v-7h-2v7z" />
                </svg>
                <span>Local File Hub</span>
            </div>

            <button class="icon-button" id="search-button">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="22" height="22">
                    <path
                        d="M10 18a7.952 7.952 0 0 0 4.897-1.688l4.396 4.396 1.414-1.414-4.396-4.396A7.952 7.952 0 0 0 18 10c0-4.411-3.589-8-8-8s-8 3.589-8 8 3.589 8 8 8zm0-14c3.309 0 6 2.691 6 6s-2.691 6-6 6-6-2.691-6-6 2.691-6 6-6z" />
                </svg>
            </button>
        </div>

        <div class="nav-bar-header">
            <button class="icon-button back-button" id="back-button" style="display: none;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
                    <path d="M13.293 6.293 7.586 12l5.707 5.707 1.414-1.414L10.414 12l4.293-4.293z" />
                </svg>
            </button>

            <div class="path-scroll-container">
                <div id="current-path-text" class="path-text">/</div>
            </div>
        </div>

        <div class="search-container" id="search-container" style="display: none;">
            <input type="text" id="search-input" placeholder="Type to search files..." autocomplete="off">
            <button id="close-search" class="icon-button small">âœ•</button>
        </div>

        <main class="scroll-area">
            <div class="file-list-container" id="file-list">
            </div>
        </main>

        <div class="bottom-section">
            <nav class="bottom-nav">
                <button class="nav-item active" id="nav-files">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M20 5h-9.586L8.707 3.293A.999.999 0 0 0 8 3H4c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h16c1.103 0 2-.897 2-2V7c0-1.103-.897-2-2-2zm0 14H4V5h3.586l2 2H20v12z" />
                    </svg>
                    <span>Files</span>
                </button>

                <button class="nav-item" id="nav-settings">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.488.488 0 0 0-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41h-3.84a.484.484 0 0 0-.48.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96a.488.488 0 0 0-.59.22L2.09 8.83a.49.49 0 0 0 .12.61l2.03 1.58c-.05.31-.07.63-.07.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.27.41.48.41h3.84c.24 0 .44-.17.48-.41l.36-2.54c.59-.24 1.13-.57 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z" />
                    </svg>
                    <span>Settings</span>
                </button>
            </nav>
        </div>

    </div>

    <button class="fab" id="fab-main">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 11h-6V5h-2v6H5v2h6v6h2v-6h6z" />
        </svg>
    </button>

    <div class="fab-menu" id="fab-menu">
        <button class="fab-menu-item" id="new-folder-btn">
            <span>New Folder</span>
            <div class="icon-wrapper">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#58A6FF">
                    <path
                        d="M10 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V8C22 6.9 21.1 6 20 6H12L10 4Z" />
                </svg>
            </div>

        </button>
        <button class="fab-menu-item" id="new-file-btn">
            <span>New File</span>
            <div class="icon-wrapper">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#8B949E">
                    <path d="M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V8L14 2Z" />
                    <path d="M14 2V8H20" fill="#8B949E" />
                </svg>
            </div>

        </button>
    </div>

    <div class="modal-overlay" id="modal-overlay"></div>

    <div class="modal" id="settings-modal">
        <h3>Settings</h3>
        <div style="text-align: left; color: #8B949E; font-size: 0.9em; line-height: 1.6;">
            <p><strong>Role:</strong> {{ role|title }}</p>
            <p><strong>Connection:</strong> Secure</p>
            <p style="margin-top: 10px; font-style: italic;">Local File Hub v2.0</p>
        </div>
        <div class="modal-actions" style="justify-content: center; margin-top: 25px;">
            <button type="button" class="modal-button cancel" data-close-modal>Close</button>
            <a href="/logout" class="modal-button submit danger"
                style="text-decoration: none; text-align: center;">Logout</a>
        </div>
    </div>

    <div class="modal" id="create-folder-modal">
        <h3>Create New Folder</h3>
        <form id="create-folder-form">
            <input type="text" id="new-folder-name" placeholder="Folder Name" required autocomplete="off">
            <div class="modal-actions">
                <button type="button" class="modal-button cancel" data-close-modal>Cancel</button>
                <button type="submit" class="modal-button submit">Create</button>
            </div>
        </form>
    </div>

    <div class="modal" id="upload-file-modal">
        <h3>Upload File</h3>

        <div id="upload-step-1">
            <form id="upload-form-dummy">
                <label for="file-upload" class="custom-file-upload">
                    <span id="file-upload-filename">No file chosen</span>
                    <span class="browse-btn">Browse</span>
                </label>
                <input type="file" id="file-upload" required>

                <input type="text" id="file-rename-input" placeholder="File Name (Optional)"
                    style="display: none; width: 100%; padding: 12px; margin-top: 10px; background-color: #0B0E14; border: 1px solid #30363D; color: white; border-radius: 8px; outline: none;">

                <div class="modal-actions" style="margin-top: 15px;">
                    <button type="button" class="modal-button cancel" data-close-modal>Cancel</button>
                    <button type="button" id="start-upload-btn" class="modal-button submit">Start Upload</button>
                </div>
            </form>
        </div>

        <div id="upload-step-2" style="display: none;">
            <div
                style="display: flex; justify-content: space-between; margin-bottom: 5px; color: #8B949E; font-size: 0.9em;">
                <span id="upload-status-text">Uploading...</span>
                <span id="upload-percentage">0%</span>
            </div>

            <div
                style="background-color: #333; height: 8px; border-radius: 4px; overflow: hidden; margin-bottom: 15px;">
                <div id="upload-progress-bar"
                    style="width: 0%; height: 100%; background-color: #3B82F6; transition: width 0.2s;"></div>
            </div>

            <div class="modal-actions">
                <button type="button" id="pause-upload-btn" class="modal-button cancel">Pause</button>
                <button type="button" id="cancel-upload-btn" class="modal-button submit danger">Cancel</button>
            </div>
        </div>
    </div>

    <div class="modal" id="delete-confirm-modal">
        <h3>Confirm Deletion</h3>
        <p>Are you sure you want to delete "<span id="delete-item-name"
                style="color: white; font-weight: bold;"></span>"?</p>
        <p class="danger" style="font-size: 0.9em; margin-bottom: 10px;">This action cannot be undone.</p>

        <form id="delete-confirm-form">
            <input type="password" id="delete-password" placeholder="Enter Root Password" required autocomplete="off">
            <div class="modal-actions">
                <button type="button" class="modal-button cancel" data-close-modal>Cancel</button>
                <button type="submit" class="modal-button submit danger">Delete</button>
            </div>
        </form>
    </div>

    <div class="loading-spinner" id="loading-spinner">
        <div class="spinner"></div>
    </div>
    <div class="toast" id="toast-notification"><span id="toast-message"></span></div>

    <script>
        window.userRole = "{{ role }}"; 
    </script>
    <script src="{{ url_for('static', filename='app.js') }}"></script>

</body>

</html>