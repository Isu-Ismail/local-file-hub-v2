<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Local File Hub</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
</head>

<body>

    <div class="app-layout">

        <div class="top-section">
            <header>
                <div class="header-left">
                    <button class="icon-button back-button" id="back-button" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M13.293 6.293 7.586 12l5.707 5.707 1.414-1.414L10.414 12l4.293-4.293z" />
                        </svg>
                    </button>
                    <div class="path-display">
                        <span class="path-label">Current Path:</span>
                        <span id="current-path-text" class="path-text">/</span>
                    </div>
                </div>

                <div class="breadcrumbs" id="breadcrumbs-container">
                    <a href="#" data-path="">/</a>
                </div>

                <div class="search-container" id="search-container" style="display: none;">
                    <input type="text" id="search-input" placeholder="Search...">
                    <button id="close-search" class="icon-button small">âœ•</button>
                </div>

                <div class="header-actions">
                    <button class="icon-button" id="search-button">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path
                                d="M10 18a7.952 7.952 0 0 0 4.897-1.688l4.396 4.396 1.414-1.414-4.396-4.396A7.952 7.952 0 0 0 18 10c0-4.411-3.589-8-8-8s-8 3.589-8 8 3.589 8 8 8zm0-14c3.309 0 6 2.691 6 6s-2.691 6-6 6-6-2.691-6-6 2.691-6 6-6z" />
                        </svg>
                    </button>
                </div>
            </header>

            <div class="filter-bar">
                <button class="filter-button" id="filter-button">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z" />
                    </svg>
                    <span>Filter</span>
                </button>
                <button class="filter-button" id="sort-button">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 18h6v-2H3v2zM3 6v2h18V6H3zm0 7h12v-2H3v2z" />
                    </svg>
                    <span>Sort</span>
                </button>
            </div>
        </div>

        <main class="scroll-area" id="main-scroll-area">
            <div class="file-list-container" id="file-list">
            </div>
        </main>

        <div class="bottom-section">
            <nav class="bottom-nav">
                <button class="nav-item active">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M13 9h-2V7h2v2zm0 4h-2v-2h2v2zm-2 2h2v2h-2v-2zM20 5h-9.586L8.707 3.293A.999.999 0 0 0 8 3H4c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h16c1.103 0 2-.897 2-2V7c0-1.103-.897-2-2-2zm0 14H4V5h3.586l2 2H20v12z" />
                    </svg>
                    <span>Files</span>
                </button>
                <button class="nav-item">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="m2.344 15.271 2 3.464a1 1 0 0 0 1.366.365l2.596-1.5a1 1 0 0 0 1.157-1.23l-1-4.636a1 1 0 0 0-.365-1.366l-3.464-2-1.5 2.598a1 1 0 0 0 1.23 1.157l4.636 1a1 1 0 0 0 1.366-.365l2-3.464a1 1 0 0 0-.365-1.366l-2.598-1.5a1 1 0 0 0-1.23 1.157l-1 4.636a1 1 0 0 0 .365 1.366l3.464 2 1.5-2.598a1 1 0 0 0-1.23-1.157l-4.636-1a1 1 0 0 0-1.366.365l-2 3.464a1 1 0 0 0 .365 1.366l2.598 1.5a1 1 0 0 0 1.23-1.157l.5-2.318a1 1 0 0 0-.365-1.366l-3.464-2a1 1 0 0 0-1.366.365z" />
                    </svg>
                    <span>Settings</span>
                </button>
            </nav>
        </div>

    </div> <button class="fab" id="fab-main">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 11h-6V5h-2v6H5v2h6v6h2v-6h6z" />
        </svg>
    </button>

    <div class="fab-menu" id="fab-menu">
        <button class="fab-menu-item" id="new-folder-btn">
            <span>New Folder</span>
            <div class="icon-wrapper">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path
                        d="M10 4H4c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h16c1.103 0 2-.897 2-2V8c0-1.103-.897-2-2-2h-8l-2-2z" />
                </svg>
            </div>
        </button>
        <button class="fab-menu-item" id="new-file-btn">
            <span>New File</span>
            <div class="icon-wrapper">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path
                        d="M15 5H9a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1zM9 4a3 3 0 0 1 3-3h0a3 3 0 0 1 3 3v0h-6V4zM4 11h1v2H4v-2zm0-4h1v2H4V7zm0 8h1v2H4v-2zm16 1V6a1 1 0 0 0-1-1h-2v14h2a1 1 0 0 0 1-1zm-4 0V5h-2v14h2z" />
                </svg>
            </div>
        </button>
    </div>

    <div class="modal-overlay" id="modal-overlay"></div>

    <div class="modal" id="create-folder-modal">
        <h3>Create New Folder</h3>
        <form id="create-folder-form">
            <input type="text" id="new-folder-name" placeholder="Folder Name" required autocomplete="off">
            <div class="modal-actions">
                <button type="button" class="modal-button cancel" data-close-modal>Cancel</button>
                <button type="submit" class="modal-button submit">Create</button>
            </div>
        </form>
    </div>

    <div class="modal" id="upload-file-modal">
        <h3>Upload File</h3>

        <div id="upload-step-1">
            <form id="upload-form-dummy">
                <label for="file-upload" class="custom-file-upload">
                    <span id="file-upload-filename">No file chosen</span>
                    <span class="browse-btn">Browse</span>
                </label>
                <input type="file" id="file-upload" required>

                <input type="text" id="file-rename-input" placeholder="File Name (Optional)"
                    style="display: none; width: 100%; padding: 10px; margin-top: 10px; background-color: #0B0E14; border: 1px solid #2B3240; color: white; border-radius: 6px; outline: none;">

                <div class="modal-actions" style="margin-top: 15px;">
                    <button type="button" class="modal-button cancel" data-close-modal>Cancel</button>
                    <button type="button" id="start-upload-btn" class="modal-button submit">Start Upload</button>
                </div>
            </form>
        </div>

        <div id="upload-step-2" style="display: none;">
            <div
                style="display: flex; justify-content: space-between; margin-bottom: 5px; color: #8B949E; font-size: 0.9em;">
                <span id="upload-status-text">Uploading...</span>
                <span id="upload-percentage">0%</span>
            </div>

            <div
                style="background-color: #333; height: 8px; border-radius: 4px; overflow: hidden; margin-bottom: 15px;">
                <div id="upload-progress-bar"
                    style="width: 0%; height: 100%; background-color: #2F81F7; transition: width 0.2s;"></div>
            </div>

            <div class="modal-actions">
                <button type="button" id="pause-upload-btn" class="modal-button cancel">Pause</button>
                <button type="button" id="cancel-upload-btn" class="modal-button submit danger">Cancel</button>
            </div>
        </div>
    </div>

    <div class="modal" id="delete-confirm-modal">
        <h3>Confirm Deletion</h3>
        <p>Are you sure you want to delete "<span id="delete-item-name" style="color: white;"></span>"?</p>
        <p class="danger" style="font-size: 0.9em; margin-bottom: 10px;">This action cannot be undone.</p>

        <form id="delete-confirm-form">
            <input type="password" id="delete-password" placeholder="Enter Root Password" required autocomplete="off">
            <div class="modal-actions">
                <button type="button" class="modal-button cancel" data-close-modal>Cancel</button>
                <button type="submit" class="modal-button submit danger">Delete</button>
            </div>
        </form>
    </div>

    <div class="loading-spinner" id="loading-spinner">
        <div class="spinner"></div>
    </div>

    <div class="toast" id="toast-notification">
        <span id="toast-message"></span>
    </div>

    <script>
        window.userRole = "{{ role }}";
        console.log("Current Role:", window.userRole);
    </script>

    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>